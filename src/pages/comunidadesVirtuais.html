<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="../images/icon.png" sizes="16x16">
    <title>ONLIB - Adoradores de livros Ficção Científica</title>
    <link rel="stylesheet" href="../css/bootstrap.css">
    <link rel="stylesheet" href="../bootstrap-icons/font/bootstrap-icons.css">
    <script src="../js/bootstrap.js"></script>
    <script src="../js/functions.js"></script>
</head>

<body>
    <nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="home.html"><strong>ONLIB</strong></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                </ul>
                <div class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle text-white" href="#" role="button" data-bs-toggle="dropdown"
                        aria-expanded="false">
                        <span class="bi-envelope-fill"></span>
                        Mensagens
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <li>
                            <a class="dropdown-item alert-primary" href="#" data-bs-toggle="modal"
                                data-bs-target="#msgComunidade">
                                <small><strong>Chat da Comunidade</strong> </small> <br>
                                <small>Bye!</small>
                            </a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="#">
                                <small>Isacc </small> <br>
                                <small>Obrigado!</small>
                            </a>
                        </li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item text-primary" href="manutencao.html"><small>Ver todas
                                    mensagens</small></a></li>
                    </ul>
                </div>
                <div class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle text-white" href="#" id="navbarDropdown" role="button"
                        data-bs-toggle="dropdown" aria-expanded="false">
                        Nome do leitor
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="meusDados.html"><small>Meus dados</small></a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="../index.html"><small>Sair</small></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav> <br>
    <div aria-live="polite" aria-atomic="true" class="position-relative">
        <div class="toast-container position-fixed end-0 p-3" id="areaToast" style="z-index: 9999; margin-top: 20px;">
        </div>
    </div>
    <!-- Modal chat -->
    <div class="modal fade" id="msgComunidade" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-success" id="titleChat" onclick="changeStatus();"
                        data-bs-toggle="tooltip" data-bs-placement="right" title="Conectado">
                        <span class="bi-people"></span> &nbsp; </sup>
                        Chat da Comunidade
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" style="height: 10000px;" id="chat">
                    <div class="modal-footer">
                        <div class="container">
                            <div class="card-body msg_card_body" id="bodyContent">
                            </div>
                            <div class="card-footer">
                                <div class="input-group">

                                    <textarea name="message" id="message" class="form-control type_msg"
                                        placeholder="Escreva sua mensagem..."></textarea>
                                    <div class="input-group-append">
                                        <button id="submit" type="" class="input-group-text send_btn"><i
                                                name="send"></i> <span class="bi-reply"></span>
                                        </button>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div><br><br><br>
    <div id="header"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-3 col-sm-12"> </div>
            <div class="col-lg-9 col-sm-12">
                <h3><br>Adoradores de livros Ficção Científica</h3>
            </div>
            <div class="col-lg-3 col-sm-12">
                <div class="list-group" id="list-tab" role="tablist">
                    <a class="list-group-item list-group-item-action active" id="list-home-list" data-bs-toggle="list"
                        href="#list-home" role="tab" aria-controls="aulas"> <span class="bi bi-book"></span>
                        Principal</a>
                    <a class="list-group-item list-group-item-action" href="#"
                        onclick="toast('Não há notícias cadastradas :/')"> <span class="bi bi-journals"></span> Notícias
                    </a>
                    <a class="list-group-item list-group-item-action" id="list-participantes-list" data-bs-toggle="list"
                        href="#list-participantes" role="tab" aria-controls="aulas"> <span class="bi bi-people"></span>
                        Participantes</a>
                </div>
            </div>
            <div class="col-lg-9 col-sm-12">
                <hr>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="home.html">Página Inicial</a></li>
                        <li class="breadcrumb-item"><a href="home.html">Minhas Comunidades</a></li>
                        <li class="breadcrumb-item" aria-current="page">Adoradores de livros</li>
                    </ol>
                </nav>
                <div class="tab-content" id="nav-tabContent">
                    <div class="tab-pane fade show active" id="list-home" role="tabpanel"
                        aria-labelledby="list-home-list">
                        <div class="card">
                            <div class="card-body" style="text-align: justify">
                                Descrição <br>
                                <small id="descricao">
                                    <br>
                                    <h6> Se você é novo aqui seja Bem-Vind@ </h6>
                                    <p> A comunidade é uma plataforma para compartilhar e recomendar livros sobre ficção
                                        científica a todos os seus participantes.
                                        Um lugar onde todos os membros da comunidade podem trabalhar juntos para
                                        melhorar o catálogo de livros do ONLIB.Com a comunidade do ONLIB você pode para
                                        transferir mensagens, fornecer informações e expressar emoções sobre os livros.
                                        Não esqueça de visitar a aba de notícias para ficar sempre atualizado sobre o
                                        catálago de livros de Ficção Científica. </p>
                                </small>
                                <small><a href="#list-home-list" id="descricao-ver-mais">[Ver mais]</a></small>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="list-participantes" role="tabpanel"
                        aria-labelledby="list-messages-list">
                        <table class="table align-middle">
                            <thead>
                                <tr>
                                    <th colspan="3">Participantes</th>
                                </tr>
                            </thead>
                            <tbody class="text-center">
                                <tr>
                                    <td>
                                        <div class="text-center" style="width: 200px;">
                                            <img src="../images/austronauta.png" class="rounded" alt="..."
                                                style="width: 100%;">
                                            <p> <span class="bi bi-person"></span>nomeDefault
                                                <small><strong>[administrador]</strong></small> <br> <small><a href="">
                                                        <i class="bi bi-envelope"></i> Enviar mensagem</a></small>
                                            </p>
                                        </div>

                                    </td>

                                    <td>
                                        <div class="text-center" style="width: 200px;">
                                            <img src="../images/isacc2.jpg" class="rounded" alt="..."
                                                style="width: 100%;">
                                            <p> <span class="bi bi-person"></span>nomeDefault <br> <small><a href=""> <i
                                                            class="bi bi-envelope"></i> Enviar mensagem</a></small> </p>
                                        </div>

                                    </td>
                                    <td>
                                        <div class="text-center" style="width: 200px;">
                                            <img src="../images/isacc.jpg" class="rounded" alt="..."
                                                style="width: 100%;">
                                            <p> <span class="bi bi-person"></span>nomeDefault <br> <small><a href=""> <i
                                                            class="bi bi-envelope"></i> Enviar mensagem</a></small> </p>
                                        </div>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="footer"></div>
</body>
<script>
    include("../includes/footer.html", "footer");

    let btnDescricao = document.getElementById('descricao-ver-mais')
    btnDescricao.addEventListener("click", (e) => {
        if (btnDescricao.text == "[Ver mais]") {
            btnDescricao.text = "[Ver menos]";
            document.getElementById('descricao').innerHTML = "<br> <h6> Se você é novo aqui seja Bem-Vind@ </h6> <p> A comunidade é uma plataforma para compartilhar e recomendar livros sobre ficção científica a todos os seus participantes. Um lugar onde todos os membros da comunidade podem trabalhar juntos para melhorar o catálogo de livros do ONLIB.Com a comunidade do ONLIB você pode para transferir mensagens, fornecer informações e expressar emoções sobre os livros. Não esqueça de visitar a aba de notícias para ficar sempre atualizado sobre o catálago de livros de Ficção Científica. </p> "
        } else {
            btnDescricao.text = "[Ver mais]";
            document.getElementById('descricao').innerHTML = "<br> <h6> Se você é novo aqui seja Bem-Vind@ </h6> A comunidade é uma plataforma para compartilhar e recomendar livros sobre ficção científica a todos os seus participantes. "
        }

    });
</script>

</html>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-app.js";
    import {
        getDatabase,
        set,
        ref,
        push,
        child,
        onValue,
        onChildAdded
    } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyB_gcZwYMMlqCFo9h5-yQOtaANmryETCZA",
        authDomain: "chat-3987c.firebaseapp.com",
        databaseURL: "https://chat-3987c-default-rtdb.firebaseio.com",
        projectId: "chat-3987c",
        storageBucket: "chat-3987c.appspot.com",
        messagingSenderId: "508745708430",
        appId: "1:508745708430:web:a5cb2ba9b3097dbff22adf",
        measurementId: "G-Q2JFEQ0E3B"
    };

    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    var myName = prompt("Como você quer ser chamado?");

    submit.addEventListener('click', (e) => {
        var message = document.getElementById('message').value;
        var name = myName;
        const id = push(child(ref(database), 'messages')).key;

        set(ref(database, 'messages/' + id), {
            name: name,
            message: message
        });
        document.getElementById('message').value = "";
        // alert('message has sent');

    });

    const newMsg = ref(database, 'messages/');
    onChildAdded(newMsg, (data) => {
        if (data.val().name != myName) {
            var divData = '<div class="d-flex justify-content-start mb-4" id="fromDiv">\n' +
                '                        <div class="img_cont_msg">\n' +
                '                            <img src ="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRQxp-HnIDy2TEZnGa181pQcDLb7tyPrd0D8w&usqp=CAU"\n' +
                '                                 width="32" height="32" class="rounded-circle user_img_msg">\n' +
                '                        </div>\n' +
                '                        <div class="msg_cotainer" >\n' +
                '                            ' + data.val().message + '' +
                '                            <span class="msg_time"></span>\n' +
                '                        </div>\n' +
                '                    </div>';
            var d1 = document.getElementById('bodyContent');
            d1.insertAdjacentHTML('beforebegin', divData);
        } else {
            var divData = '<div class="d-flex justify-content-end mb-4">\n' +
                '                        <div class="msg_cotainer_send" id="sendDiv">\n' +
                '                            ' + data.val().message + '' +
                '                                         </div>\n' +
                '                        <div class="img_cont_msg">\n' +
                '                            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSlMwkUd306XB0p0KvvjWj9eMTndkDyYFkM5Q&usqp=CAU"\n' +
                '                                width="32" height="32"style="width 15%"\n' +
                '                                 class="rounded-circle user_img_msg">\n' +
                '                        </div>\n' +
                '                    </div>';
            var d1 = document.getElementById('bodyContent');
            d1.insertAdjacentHTML('beforebegin', divData);
        }
    });

</script>

<script>
    $(document).ready(function () {
        $('#action_menu_btn').click(function () {
            $('.action_menu').toggle();
        });
    });
</script>